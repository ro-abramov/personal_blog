---
title: Some advice on loading performance
date: '2018-11-12'
cover: ./cover.jpg
photographer:
    login: 'marcojodoin'
    name: 'Marc-Olivier Jodoin'
coverImageOrientation: 'horizontal'
lang: 'en'
---

It shouldn't be a secret that modern web apps are supposed to load in a thousand of a second, and work as smooth as native app. Tools for finding application bottlenecks are created for developers. For instance, in Google Chrome there are really awesome tools for auditing application performance, and other vendors also try not to fall behind (probably). React team has made some improvements in its devtool extension, and has added a new profiler. If you haven't tried it yet, then you definitely should at least read a [blog post](https://reactjs.org/blog/2018/09/10/introducing-the-react-profiler.html).

Addie Osmani is the master of performance optimizations. He has lots of must-read resources about how not to ruin your performance. I insist on adding his [blog](https://medium.com/@addyosmani) to bookmarks in order to becoming a real üßô‚Äç of speed.

In the article I'll try to give some practical advice with an easy explanation of some tips.

## üë®‚Äçüíª Preloading

Let me start with data preloading. Imagine that we have a following issue and then try to find a good solution. So we have the following page.

```html
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" />
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>
<link rel="stylesheet" href="/styles/main.css" />
```

And in file `main.css` we try to load custom font.

```css
@font-face {
    font-family: 'Mali';
    font-style: normal;
    font-weight: 400;
    src: url(/fonts/mali/Mali-Regular.ttf) format('truetype');
}
```

> Important: In the example we load file in ttf extension for purpose. The first step to optimize performance should be using standard font, and if the UX engineer insist on using custom font - then you must use modern file formats, like woff/woff2 [link](https://transfonter.org/formats). I've used Truetype font in order to increase the loading time.

Open network tab in browser console and reload the page.

![Before preloading](./fonts_before.png)

So what we may notice here. At first the browser downloads styles and scripts, and only after this - font files. Please notice that browser starts downloading font files only after the font _actually_ applies to element. For a short period of time the text hasn't displayed at all.

The text with default font appears only after 8 second after initial request, and with custom font only after 9 second. (I am going to speak in detail about fonts application later in this post).

So could we somehow tell browser to load the font file in advance? Without waiting for actual application.

Preloading is going to help in that situation. We should implement several easy steps.

Step 1. Add link to resource with preload attribute in html document.

```html
<!-- –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ -->
<link rel="preload" as="font" crossorigin="crossorigin" type="font/ttf" href="/fonts/mali/Mali-Regular.ttf" />
<!-- /–ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ -->
<link
    rel="stylesheet"
    href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
    integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
    crossorigin="anonymous"
/>
<script
    src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
    integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
    crossorigin="anonymous"
></script>
<link rel="stylesheet" href="/styles/main.css" />
```

Step two. Grab some üçª and enjoy.

![After preloading](./fonts_after.png)

–ü—Ä–∏ –ø—Ä–æ—á–∏—Ö —Ä–∞–≤–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è –º—ã –º–æ–∂–µ–º –Ω–∞–±–ª—é–¥–∞—Ç—å, —á—Ç–æ —Ç–µ–ø–µ—Ä—å —à—Ä–∏—Ñ—Ç—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Å—Ä–∞–∑—É –≤–º–µ—Å—Ç–µ —Å –¥—Ä—É–≥–∏–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏. –ò —É–∂–µ –Ω–∞ 7 —Å–µ–∫—É–Ω–¥–µ –º—ã –ø–æ–ª—É—á–∞–µ–º —É–∂–µ –≥–æ—Ç–æ–≤—É—é –æ—Ç—Ä–∏—Å–æ–≤–∞–Ω–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É. –ù–∞—à –≤—ã–∏–≥—Ä—ã—à —Å–æ—Å—Ç–∞–≤–∏–ª 1 —Å–µ–∫—É–Ω–¥—É. –°–µ–∫—É–Ω–¥—É, –ö–∞—Ä–¥, –º—ã —Å—É–º–µ–ª–∏ –≤—ã–∏–≥—Ä–∞—Ç—å —Ç–∞–∫–∏–º –ø—Ä–æ—Å—Ç—ã–º —Ö–∞–∫–æ–º. –ù–æ –µ—Å–ª–∏ –≤—Å–µ —Ç–∞–∫ –ø—Ä–æ—Å—Ç–æ, —Ç–æ –¥–∞–≤–∞–π—Ç–µ –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∂–∞—Ç—å –≤—Å–µ —Ä–µ—Å—É—Ä—Å—ã —Å—Ä–∞–∑—É.

–ù–æ –≤—Å–µ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ç–∞–∫ —Ö–æ—Ä–æ—à–æ, –∏ —Å –±–æ–ª—å—à–æ–π —Å–∏–ª–æ–π –ø—Ä–∏—Ö–æ–¥–∏—Ç –∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å. –ù–∞ HTTP/1 –±—Ä–∞—É–∑–µ—Ä —É–º–µ–µ—Ç —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å 6 —Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –∫ –æ–¥–Ω–æ–º—É —Ö–æ—Å—Ç—É. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —É—Å—Ç–∞–Ω–æ–≤–∏–≤ –ø–æ–≤—ã—à–µ–Ω–Ω—ã–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –Ω–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ –æ–¥–Ω–∏–º —Ñ–∞–π–ª–∞–º, –º—ã –æ—Ç–∫–ª–∞–¥—ã–≤–∞–µ–º —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ –¥—Ä—É–≥–∏—Ö —Ñ–∞–π–ª–æ–≤.

–¢–∞–∫ —á—Ç–æ –∂–µ —Å–ª–µ–¥—É–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –Ω–∞ –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫—É. –ö–∞–∫ –≥–æ–≤–æ—Ä–∏—Ç—Å—è –≤–æ –º–Ω–æ–≥–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–∞—Ö "–¢–æ —á—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–ª—è —Ç–µ–∫—É—â–µ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–∏". WTf? –î–ª—è —Å–µ–±—è —è —Å—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞–ª —Ç–∞–∫–æ–µ –ø—Ä–∞–≤–∏–ª–æ. –ï—Å–ª–∏ —É –≤–∞—Å –≤–Ω—Ç—É—Ä–∏ —Å—Ç–∏–ª–µ–π –∏–ª–∏ –≤–Ω—É—Ç—Ä–∏ —Å–∫—Ä–∏–ø—Ç–æ–≤ –µ—Å—Ç—å —Å—Å—ã–ª–∫–∏ –Ω–∞ —Ä–µ—Å—É—Ä—Å—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã –¥–ª—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã - —Ç–æ —Å—Ç–æ–∏—Ç –ø–æ–¥—É–º–∞—Ç—å –æ —Ç–æ–º —á—Ç–æ–±—ã –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∏—Ö –Ω–∞ –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞. –ü–æ—á–µ–º—É –≤—Å–µ –µ—â–µ —Å—Ç–æ–∏—Ç –ø–æ–¥—É–º–∞—Ç—å? –î–∞–ª—å—à–µ —Å—Ç–æ–∏—Ç —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∫–∞–∂–¥—ã–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Å–ª—É—á–∞–π –∏ –¥—É–º–∞—Ç—å —á—Ç–æ–∂–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Ä–∞–Ω—å—à–µ.

–ï—â–µ –æ–¥–∏–Ω –≤–∞–∂–Ω—ã–π –º–æ–º–µ–Ω—Ç. –í–µ—Ä–Ω–µ–º—Å—è –∫ SPA –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º. –î–æ–ø—É—Å—Ç–∏–º —É –Ω–∞—Å –µ—Å—Ç—å –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π —Ä–æ—É—Ç–∏–Ω–≥, –∏ –∫–æ–¥ –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø–æ–¥–≥—Ä—É–∂–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω—ã–º —á–∞–Ω–∫–æ–º. –ê –Ω–µ–ª—å–∑—è –ª–∏ –ø–æ–¥–≥—Ä—É–∂–∞—Ç—å —ç—Ç–∏ —á–∞–Ω–∫–∏ –∫–æ–¥–∞, —á—Ç–æ–±—ã –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–µ—à–∏–ª –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É, –µ–º—É –Ω–µ –ø—Ä–∏—à–ª–æ—Å—å –±—ã –∂–¥–∞—Ç—å –ø–æ–∫–∞ –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è —Ñ–∞–π–ª —Å–∫—Ä–∏–ø—Ç–æ–≤? –û—Ç–≤–µ—Ç - **–Ω–µ—Ç.** –°–º. –≤—ã—à–µ. –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ –Ω—É–∂–Ω–∞ —á—Ç–æ–±—ã –ø–æ–º–æ—á—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –±—ã—Å—Ç—Ä–µ–µ –ø–æ–ª—É—á–∏—Ç—å –æ—Ç—Ä–∏—Å–æ–≤–∞–Ω–Ω—É—é —Ç–µ–∫—É—â—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É, –¥–ª—è –±—É–¥—É—â–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ –Ω–µ –ø–æ–º–æ–∂–µ—Ç. –í Google Chrome –±—É–¥–µ—Ç –¥–∞–∂–µ –≤—ã–±—Ä–æ—à–µ–Ω warning –≤ –∫–æ–Ω—Å–æ–ª—å –æ —Ç–æ–º —á—Ç–æ –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–π —Ä–µ—Å—É—Ä—Å –Ω–µ –±—ã–ª –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –≤ —Ç–µ—á–µ–Ω–∏–∏ 3 —Å–µ–∫—É–Ω–¥.

–ù–æ –≥–¥–µ –∂–µ –Ω–∞–º –∏—Å–∫–∞—Ç—å —Å–ø–∞—Å–µ–Ω–∏—è?

## Prefetching

–ü–æ–ø—Ä–æ–±—É–µ–º –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å —Å–ª–µ–¥—É—é—â—É—é —Å–∏—Ç—É–∞—Ü–∏—é, –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –µ—Å—Ç—å –ø–æ–ø–∞–ø –≤–Ω—É—Ç—Ä–∏ –∫–æ—Ç–æ—Ä–æ–≥–æ –µ—Å—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ. –ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º —á—Ç–æ –ø–æ–ø–∞–ø –∏ –µ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç –Ω–µ –Ω–µ—Å—É—Ç –±–æ–ª—å—à–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏, –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä–æ–µ—Ç –µ–≥–æ —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –∫–∞–∫–æ–π-—Ç–æ –ø—Ä–æ–º–µ–∂—É—Ç–æ–∫ –≤—Ä–µ–º–µ–Ω–∏ –∏–ª–∏ –ø–æ –Ω–∞—Å—Ç—É–ø–ª–µ–Ω–∏—é –∫–∞–∫–æ–≥–æ-–ª–∏–±–æ —Å–æ–±—ã—Ç–∏—è. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –≤—ã–≤–æ–¥, —á—Ç–æ –∫–∞—Ä—Ç–∏–Ω–∫—É –≤–Ω—Ç—É—Ä–∏ –º–æ–∂–Ω–æ –∏ –Ω–µ –≥—Ä—É–∑–∏—Ç—å –¥–ª—è –Ω–∞—á–∞–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã. –ê –∑–∞–≥—Ä—É–∂–∞—Ç—å —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ–º –æ—Ç–∫—Ä—ã—Ç–∏–∏ –ø–æ–ø–∞–ø–∞.

–ü–æ–¥–æ–±–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –º–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–æ—Å—Ç–æ.

```html
<button class="btn btn-primary" id="btn">Click</button>
<dialog id="dlg">
    <section>
        <header>Hi, I am a modal dialog</header>
        <img data-src="/photo.jpg" width="200" />
    </section>
</dialog>
```

–ò –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫

```js
document.getElementById('btn').addEventListener('click', () => {
    dlg.showModal()
    const images = document.querySelectorAll('img[data-src]')
    for (let image of images) {
        image.src = image.dataset.src
        image.removeAttribute('data-src')
    }
})
```

–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –º—ã –ø–æ–ª—É—á–∞–µ–º:

![prefetch_before](./prefetch_before.gif)

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É. –ù–æ —á—Ç–æ –µ—Å–ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–µ, –∞ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –Ω–µ —Å–∞–º–æ–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ. –í —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –æ—Ç—Ä–∏—Å–æ–≤—ã–≤–∞—Ç—å—Å—è –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ, –∞ —ç—Ç–æ üí© –∞ –Ω–µ good user experience. –ù–∞ –ø–æ–º–æ—â—å –Ω–∞–º –ø—Ä–∏–¥—ë—Ç prefetch.

Prefetch - —ç—Ç–æ —Å–≤–æ–µ–≥–æ –≤–∏–¥–∞ –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω—ã–π –∑–∞–ø—Ä–æ—Å, –æ—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ª—å –∫–æ—Ç–æ—Ä–æ–≥–æ —Å —Å–∞–º—ã–º –Ω–∏–∑–∫–∏–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º, –≤ –º–æ–º–µ–Ω—Ç –∫–æ–≥–¥–∞ –≤ –±—Ä–∞—É–∑–µ—Ä–µ –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–∏–∫–∞–∫–æ–π —Ä–∞–±–æ—Ç—ã, –∫–æ–≥–¥–∞ –≤—Å–µ —Ä–µ—Å—É—Ä—Å—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã, –∞ —Å–∫—Ä–∏–ø—Ç—ã –≤—ã–ø–æ–ª–µ–Ω—ã, —Å–∫–∞—á–∞—Ç—å —Ä–µ—Å—É—Ä—Å –∏ –ø–æ–ª–æ–∂–∏—Ç—å –µ–≥–æ –≤ –∫—ç—à. –ß—Ç–æ–±—ã –≤ –¥–∞–ª—å–Ω–µ–π—à–µ–º –¥–æ—Å—Ç–∞—Ç—å –µ–≥–æ –∏–∑ –∫—ç—à–∞ –∏ –Ω–µ –¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å–æ–∑–µ—Ä—Ü–∞—Ç—å –≤–µ–ª–∏–∫–æ–ª–µ–ø–Ω—É—é –∑–∞–≥—Ä—É–∑–∫—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.

–í—Å–µ —á—Ç–æ –Ω–∞–º —Å—Ç–æ–∏—Ç —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ –¥–æ–±–∞–≤–∏—Ç—å –æ–¥–Ω—É –Ω–æ–≤—É—é —Å—Ç—Ä–æ—á–∫—É

```html
<dialog id="dlg">
    <section>
        <header>Hi, I am a modal dialog</header>
        <!-- Prefetch -->
        <link rel="prefetch" as="image" href="/photo.jpg" />
        <!-- /Prefetch -->
        <img data-src="/photo.jpg" width="200" />
    </section>
</dialog>
```

![prefetch_after](./prefetch_after.gif)

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –∫–∞—Ä—Ç–∏–Ω–∫–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –¥–æ —Ç–æ–≥–æ –∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∞–ª –Ω–∞ –∫–Ω–æ–ø–∫—É, –∞ —É–∂–µ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –¥–∏–∞–ª–æ–≤–æ–≥–æ –æ–∫–Ω–∞ - —Ñ–∞–π–ª –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑ –∫—ç—à–∞.

–ö–∞–∫ –∏ –∫ preload, –∫ prefetch —Ç–æ–∂–µ –Ω–∞–¥–æ –æ—Ç–Ω–æ—Å–∏—Ç—å—Å—è —Å –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç—å—é. –ö –ø—Ä–∏–º–µ—Ä—É –µ—Å–ª–∏ —ç—Ç–æ—Ç –ø–æ–ø–∞–ø –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –º–µ–Ω–µ–µ —á–µ–º –≤ 5% —Å–ª—É—á–∞–µ–≤ –∑–∞—Ö–æ–¥–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É, —Ç–æ –∑–∞—á–µ–º –∑–∞—Å—Ç–∞–≤–ª—è—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–µ—Ä–µ–ø–ª–∞—á–∏–≤–∞—Ç—å –∑–∞ –∑–∞–∫–∞—á–∫—É —Ä–µ—Å—É—Ä—Å–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –∏–º –∏ –Ω–µ –ø—Ä–∏–≥–æ–¥—è—Ç—Å—è?

## –¢–µ–∫—É—â–∏–π –∏—Ç–æ–≥

–ò—Ç–∞–∫, –µ—Å–ª–∏ –ø–æ–¥–≤–µ—Å—Ç–∏ –Ω–µ–±–æ–ª—å—à–æ–π –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π –∏—Ç–æ–≥, —Ç–æ –º—ã –Ω–∞—É—á–∏–ª–∏—Å—å:

-   –ü–æ–≤—ã—à–∞—Ç—å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–µ—Å—É—Ä—Å–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ** –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –≤ —Ä–∞–º–∫–∞—Ö —Ç–µ–∫—É—â–µ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–∏. –ó–∞–ø—Ä–æ—Å –Ω–∞ –∑–∞–≥—Ä—É–∑–∫—É —Ä–µ—Å—É—Ä—Å–æ–≤ –º–æ–∂–µ—Ç –∏—Å—Ö–æ–¥–∏—Ç—å –∫–∞–∫ –∏–∑ javascript —Ç–∞–∫ –∏ –∏–∑ css.
-   –ù–µ –≥—Ä—É–∑–∏—Ç—å —Ä–µ—Å—É—Ä—Å—ã –≤ –º–æ–º–µ–Ω—Ç –Ω–∞—á–∞–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã, –∞ –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∂–∞—Ç—å –≤ –º–æ–º–µ–Ω—Ç –∫–æ–≥–¥–∞ –±—Ä–∞—É–∑–µ—Ä –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –ø—Ä–æ—Å—Ç–æ—è, —Ç.–æ. —É–ª—É—á—à–∞—è user experience.

–ù–µ–ø–ª–æ—Ö–æ–µ –Ω–∞—á–∞–ª–æ. –ß—Ç–æ –∂–µ –º—ã –µ—â–µ –ø–æ–¥—Ç—å—é–Ω–∏—Ç—å? –í —Å–µ–∫—Ü–∏–∏ –∫–æ–≥–¥–∞ –º—ã –æ—Å–≤–µ—â–∞–ª–∏ preload, —è —É–ø–æ–º–∏–Ω–∞–ª –ø—Ä–æ —Ç–æ –∫–∞–∫ –±—Ä–∞—É–∑–µ—Ä –ø—Ä–∏–º–µ–Ω—è–µ—Ç —à—Ä–∏—Ñ—Ç—ã. –ß—Ç–æ–±—ã –≤–∞–º –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å—Å—è –≤–≤–µ—Ä—Ö, –º—ã —É–ª—É—á—à–∏–ª–∏ —Å–∫–æ—Ä–æ—Å—Ç—å –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –¥–æ 7 —Å–µ–∫—É–Ω–¥. –ü—Ä–∏—á–µ–º –Ω–∞ 6-–æ–π —Å–µ–∫—É–Ω–¥–µ —Å—Ç–∏–ª–∏ –∏ —Å–∫—Ä–∏–ø—Ç—ã –≤—ã–ø–æ–ª–Ω–∏–ª–∏—Å—å, –∞ –æ—Å—Ç–∞–≤—à–µ–µ—Å—è –≤—Ä–µ–º—è –º—ã –∂–¥–µ–º –ø–æ–∫–∞ –¥–æ–∫–∞—á–∞—é—Ç—Å—è –∏ –ø—Ä–∏–º–µ–Ω—è—Ç—Å—è –∫–∞—Å—Ç–æ–º–Ω—ã–µ —à—Ä–∏—Ñ—Ç—ã. –û–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —á—Ç–æ –∏ —Å —ç—Ç–∏–º –º—ã –º–æ–∂–µ–º –ø–æ–∏–≥—Ä–∞—Ç—å—Å—è –∏ –ø–æ–ø—ã—Ç–∞—Ç—å—Å—è –¥–æ–±–∏—Ç—å—Å—è —É–ª—É—á—à–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –æ–ø—ã—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–∞–π—Ç–æ–º.

## –°–ø–æ—Å–æ–±—ã –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —à—Ä–∏—Ñ—Ç–æ–≤

–ü–æ-—É–º–æ–ª—á–∞–Ω–∏—è –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–µ–∫—Å—Ç, –ø–æ–∫–∞ –∫–∞—Å—Ç–æ–º–Ω—ã–π —à—Ä–∏—Ñ—Ç –Ω–µ –ø–æ–¥–≥—Ä—É–∑–∏—Ç—Å—è, –æ—Å—Ç–∞–≤–ª—è—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –æ–∂–∏–¥–∞–Ω–∏–∏ –ø–æ–ª—É—á–µ–Ω–∏—è –æ—Å–º—ã—Å–ª–µ–Ω–Ω–æ–π —Ç–µ–∫—Å—Ç–æ–≤–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.

![Flash of Invisible Text](./font_block.gif) _–≠—Ç–æ—Ç "—ç—Ñ—Ñ–µ–∫—Ç" –ø–æ–ª—É—á–∏–ª –Ω–∞–∑–≤–∞–Ω–∏–µ Flash of Invisible Text (–≤—Å–ø—ã—à–∫–∞ –Ω–µ–≤–∏–¥–∏–º–æ–≥–æ —Ç–µ–∫—Å—Ç–∞) –∏–ª–∏ —Å–æ–∫—Ä–∞—â–µ–Ω–Ω–æ FOIT._

–ù–∞ –Ω–∞—à–µ–º —Ç–µ—Å—Ç–æ–≤–æ–º —Å–∞–π—Ç–µ –≤—ã–º—ã—à–ª–µ–Ω–Ω–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø—Ä–∏—à–ª–æ—Å—å –±—ã –ø–æ–¥–æ–∂–¥–∞—Ç—å 1.5 —Å–µ–∫—É–Ω–¥—ã –ø—Ä–µ–∂–¥–µ —á–µ–º –ø—Ä–æ—á–∏—Ç–∞—Ç—å —É–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–π –ª–∞—Ç–∏–Ω—Å–∫–∏–π –ø—Å–µ–≤–¥–æ—Ç–µ–∫—Å—Ç. –≠—Ç–æ—Ç —Ä–µ–∂–∏–º –ø–æ–ª—É—á–∏–ª –Ω–∞–∑–≤–∞–Ω–∏–µ block.

> –ï—Å–ª–∏ –±—ã—Ç—å —Å–æ–≤—Å–µ–º –ø–µ–¥–∞–Ω—Ç–∏—á–Ω–æ —Ç–æ—á–Ω—ã–º, —Ç–æ –ø–æ-—É–º–æ–ª—á–∞–Ω–∏—é –±—Ä–∞–∑—É–µ—Ä –≤—ã—Å—Ç–∞–≤–ª–∏–≤–∞—é—Ç —Å–≤–æ–π—Å—Ç–≤–æ –≤ auto. –ù–æ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –≤–æ –≤—Å–µ—Ö —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –±—Ä–∞—É–∑–µ—Ä–∞—Ö block === auto.

–ï—Å–ª–∏ –º—ã –≤—Å–µ –∂–µ —Ö–æ—Ç–∏–º –¥–∞—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –Ω–∞—á–∞—Ç—å —á–∏—Ç–∞—Ç—å —Ç–µ–∫—Å—Ç –Ω–µ –¥–æ–∂–∏–¥–∞—è—Å—å –∑–∞–≥—Ä—É–∑–∫–∏ —à—Ä–∏—Ñ—Ç–∞, —Ç–æ –º—ã –º–æ–∂–µ–º –≤—ã—Å—Ç–∞–≤–∏—Ç—å –≤ –∑–Ω–∞—á–µ–Ω–∏–µ swap. –ì–æ–≤–æ—Ä—è –¥—Ä—É–≥–∏–º–∏ —Å–ª–æ–≤–∞–º–∏, –ø—É—Å—Ç—å –≤–Ω–∞—á–∞–ª–µ –æ—Ç—Ä–∏—Å—É–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–π –≤ —Å–ø–∏—Å–∫–µ —Å–µ–º–µ–π—Å—Ç–≤–∞ —à—Ä–∏—Ñ—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–π —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ —Å–∏—Å—Ç–µ–º–µ, –∏ –∫–æ—Ç–æ—Ä—ã–π –Ω–µ –Ω–∞–¥–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ —Å–∫–∞—á–∏–≤–∞—Ç—å, –∞ –∫–æ–≥–¥–∞ –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è –∫–∞—Å—Ç–æ–º–Ω—ã–π —à—Ä–∏—Ñ—Ç, —Ç–æ –º—ã –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ—Ä–∏—Å—É–µ–º —Ç–µ–∫—Å—Ç —Å –Ω–æ–≤—ã–º —à—Ä–∏—Ñ—Ç–æ–º.

![Flash of Unstyled Text](./font_swap.gif) _–≠—Ç–æ—Ç "—ç—Ñ—Ñ–µ–∫—Ç" –ø–æ–ª—É—á–∏–ª –Ω–∞–∑–≤–∞–Ω–∏–µ Flash of Unstyled Text (–≤—Å–ø—ã—à–∫–∞ –Ω–µ–≤–∏–¥–∏–º–æ–≥–æ —Ç–µ–∫—Å—Ç–∞) –∏–ª–∏ —Å–æ–∫—Ä–∞—â–µ–Ω–Ω–æ FOUT._

–ò —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ —á—Ç–æ –Ω–∞–º –Ω–∞–¥–æ —É–∫–∞–∑–∞—Ç—å –≤ —Ñ–∞–π–ª–µ —Å—Ç–∏–ª–µ–π

```css
@font-face {
    font-family: 'Mali';
    font-style: normal;
    font-weight: 400;
    src: url(/fonts/mali/Mali-Regular.ttf) format('truetype');
    font-display: swap;
}
```

–í–æ—Ç –æ–Ω–∞ - –∏—Å—Ç–∏–Ω–∞. –ù–æ –¥–∞–≤–∞–π—Ç–µ –ø–æ—Ä–∞–∑–º—ã—à–ª—è–µ–º –Ω–∞–¥ —Å–ª–µ–¥—É—é—â–∏–º –≤–æ–ø—Ä–æ—Å–æ–º. –ú—ã –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∂–∞–µ–º —à—Ä–∏—Ñ—Ç, –∏ –æ–Ω —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–ø—É—Å—Ç—è —Å–∫–∞–∂–µ–º 50 –º—Å –ø–æ—Å–ª–µ –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ –Ω–∞ –¥–µ—Ñ–æ–ª—Ç–Ω–æ–º —à—Ä–∏—Ñ—Ç–µ, —Ç.–æ. —É –Ω–∞—Å –ø–æ–ª—É—á–∏—Ç—Å—è —Å–ª–∏—à–∫–æ–º –±—ã—Å—Ç—Ä–æ–µ –º–µ—Ä—Ü–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞. –ß—Ç–æ –∂–µ –¥–µ–ª–∞—Ç—å? –ù–∞ –ø–æ–º–æ—â—å –ø—Ä–∏—Ö–æ–¥–∏—Ç —Å–ª–µ–¥—É—é—â–∏–µ —Å–≤–æ–π—Å—Ç–≤–æ - fallback.

–°—Ä–∞–∑—É –ø—Ä–∏–º–µ—Ä –∫–æ–¥–∞

```css
@font-face {
    font-family: 'Mali';
    font-style: normal;
    font-weight: 400;
    src: url(/fonts/mali/Mali-Regular.ttf) format('truetype');
    font-display: fallback;
}
```

This is how it now looks in network panel

![Font-display fallback](./font_fallback.gif)

–ö–∞–∫ –≤—ã –º–æ–∂–µ—Ç–µ –Ω–∞–±–ª—é–¥–∞—Ç—å –±—Ä–∞—É–∑–µ—Ä –≤–Ω–∞—á–∞–ª–µ –Ω–∏—á–µ–≥–æ –Ω–µ —Ä–∏—Å—É–µ—Ç –Ω–∞ –ø—Ä–æ—Ç—è–∂–µ–Ω–∏–µ –∫–æ—Ä–æ—Ç–∫–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞ –≤—Ä–µ–º–µ–Ω–∏, –∫–∞–∫ –≤ –ø—Ä–∏–º–µ—Ä–µ —Å–æ —Å–≤–æ–π—Å—Ç–≤–æ–º block, –∑–∞—Ç–µ–º –∞–ª–≥–æ—Ä–∏—Ç–º —Å–ª–µ–¥—É—é—â–∏–π - –µ—Å–ª–∏ —à—Ä–∏—Ñ—Ç —Å–∫–∞—á–∞–ª—Å—è –∏ –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ–≥–æ, –µ—Å–ª–∏ –Ω–µ—Ç - —Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–π —à—Ä–∏—Ñ—Ç –∏ –∂–¥–µ–º –≤ —Ç–µ—á–µ–Ω–∏–∏ 3 —Å–µ–∫—É–Ω–¥ –ø–æ–∫–∞ –ø–æ–¥–≥—Ä—É–∑–∏—Ç—Å—è –∫–∞—Å—Ç–æ–º–Ω—ã–π –∏ –∑–∞—Ç–µ–º –∫–∞–∫ –≤ –ø—Ä–∏–º–µ—Ä–µ —Å–æ swap –∑–∞–º–µ–Ω—è–µ–º —à—Ä–∏—Ñ—Ç—ã. –ï—Å–ª–∏ –Ω–∞ –ø—Ä–æ—Ç—è–∂–µ–Ω–∏–∏ 3 —Å–µ–∫—É–Ω–¥ —à—Ä–∏—Ñ—Ç —Ç–∞–∫ –∏ –Ω–µ –ø–æ–¥–≥—Ä—É–∑–∏–ª—Å—è, —Ç–æ –ø—Ä–µ–∫—Ä–∞—â–∞–µ–º –∂–¥–∞—Ç—å –∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º fallback —à—Ä–∏—Ñ—Ç.

And finally the latest option is optional

![Font-display optional](./font_optional.gif)

This is the easiest case, I think. We tell browser to give us super narrow time window, and if we have enough time to load the font then display it immediately, and if no - then use fallback font.

–£ –∫–∞–∂–¥–æ–≥–æ –∏–∑ —ç—Ç–∏—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –µ—Å—Ç—å —Å–≤–æ–∏ –ø–ª—é—Å—ã –∏ –º–∏–Ω—É—Å—ã. –ù–∞–¥–æ —Å–º–æ—Ç—Ä–µ—Ç—å –∏ –æ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ü–µ–ª–∏ –≤—ã–±–∏—Ä–∞—Ç—å —Å—Ä–µ–¥—Å—Ç–≤–æ. –ö –ø—Ä–∏–º–µ—Ä—É, –µ—Å–ª–∏ —à—Ä–∏—Ñ—Ç –º–µ–Ω—è–µ—Ç—Å—è –æ—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ - —Ç–æ —Å–æ–∑–¥–∞–µ—Ç—Å—è —ç—Ñ—Ñ–µ–∫—Ç –º–µ—Ä—Ü–∞–Ω–∏—è, –µ—Å–ª–∏ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å fallback —à—Ä–∏—Ñ—Ç –∏ –¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞—Ü–µ–ø–∏—Ç—å—Å—è –∑–∞ —Ç–µ–∫—Å—Ç –∏ –ø–æ—Ç–æ–º –ø–æ–¥–º–µ–Ω—è—Ç—å —à—Ä–∏—Ñ—Ç - —Ç–æ —Å–æ–∑–¥–∞–µ—Ç—Å—è –∫–æ–≥–Ω–∏—Ç–∏–≤–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞. –í–æ–æ–±—â–µ–º –∑–¥–µ—Å—å –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–Ω–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è - —Å—Ç–∞—Ä–∞—Ç—å—Å—è –ø–æ–¥–æ–±—Ä–∞—Ç—å fallback —à—Ä–∏—Ñ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø–æ—Ö–æ–∂–∏–º –Ω–∞ –∫–∞—Å—Ç–æ–º–Ω—ã–π, –∞ –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω–æ–µ —É–∂–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Ü–µ–ª–µ–π.

## Bonus üôÄ

Lets image a real task. We have a React or Vue project. And in that project we'd like to create several pages, and we'd also like to split the whole code into chunks based on pages, and load them when needed. We also learn that from page A to page B user is going to go in 99% of chances. It is high time to prefetch the chunk, but... The whole project is bundling with webpack, so where should we place `<link type="prefetch">`? Answer: webpack has such api out-of-the-box ü§ó

```js
import(
    /* webpackPrefetch: true */
    '/src/pages/Profile'
).then(({default}) => apply(default))
```

[Documentation](https://webpack.js.org/guides/code-splitting/#prefetching-preloading-modules)

In webpack terminology this is called magic comments and we are able to use both preload and prefetch strategies that way.

## One more bonus

I've touched only the smallest part about loading performance. This is the whole science. And if your case is only to create a fast web site without all that rocket science than give a try to [Gatsby](https://www.gatsbyjs.org/). It has lots of functionality out-of-the-box and it really some perf magic. Piece & love, react & gatsby to every one of you! ‚úåÔ∏è
